<div class="card border-0 shadow-sm rounded-4">
    <div class="card-body">
        <h6 class="fw-bold mb-3">
            <i class="bi bi-bar-chart-line-fill text-primary me-2"></i>
            Acciones registradas por día
        </h6>
        <canvas id="graficoAcciones" class="h-75"></canvas>
    </div>
</div>

<script>
let chartAcciones;

async function cargarGraficoAcciones() {
    try {
        const res = await fetch("/api/estadisticas/acciones-diarias");
        const data = await res.json();

        const labels = data.labels;
        const totales = data.data;

        if (chartAcciones) chartAcciones.destroy();

        const ctx = document.getElementById("graficoAcciones").getContext("2d");
        chartAcciones = new Chart(ctx, {
            type: "bar",
            data: {
                labels,
                datasets: [{
                    label: "Acciones registradas",
                    data: totales,
                    backgroundColor: "rgba(13, 110, 253, 0.6)",
                    borderRadius: 6,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: "top" },
                    tooltip: { mode: "index", intersect: false }
                },
                scales: {
                    x: { grid: { display: false } },
                    y: {
                        beginAtZero: true,
                        grid: { color: "#f0f0f0" },
                        title: { display: true, text: "Cantidad de acciones" }
                    }
                }
            }
        });
    } catch (err) {
        console.error("❌ Error en cargarGraficoAcciones:", err);
    }
}

document.addEventListener("DOMContentLoaded", cargarGraficoAcciones);
</script>
