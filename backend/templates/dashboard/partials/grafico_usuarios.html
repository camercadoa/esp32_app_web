<div class="card border-0 shadow-sm rounded-4">
    <div class="card-body">
        <h6 class="fw-bold mb-3">
            <i class="bi bi-person-lines-fill text-primary me-2"></i>
            Acciones por Usuario
        </h6>
        <canvas id="graficoUsuarios"></canvas>
    </div>
</div>

<script>
let chartUsuarios;

async function cargarGraficoUsuarios() {
    try {
        const res = await fetch("/api/estadisticas/acciones-por-usuario");
        const data = await res.json();

        const labels = data.labels;
        const valores = data.data;

        if (chartUsuarios) chartUsuarios.destroy();

        const ctx = document.getElementById("graficoUsuarios").getContext("2d");
        chartUsuarios = new Chart(ctx, {
            type: "bar",
            data: {
                labels,
                datasets: [{
                    label: "Cantidad de acciones",
                    data: valores,
                    backgroundColor: "rgba(13, 110, 253, 0.7)",
                    borderWidth: 1,
                    borderColor: "rgba(0,0,0,0.1)"
                }]
            },
            options: {
                responsive: true,
                indexAxis: "y",
                scales: {
                    x: { beginAtZero: true, title: { display: true, text: "Acciones ejecutadas" } },
                    y: { title: { display: true, text: "Usuario" } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: ctx => `${ctx.parsed.x} acciones`
                        }
                    }
                }
            }
        });
    } catch (err) {
        console.error("‚ùå Error en cargarGraficoUsuarios:", err);
    }
}
</script>
